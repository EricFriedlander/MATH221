---
title: "07 Linear regression with a single predictor"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(openintro)
library(tidyverse)

gradethis::gradethis_setup()
knitr::opts_chunk$set(echo = FALSE)
```


## Part 1

### Correlation

We are going to start today's lesson by going over correlation. Recall that the formula for correlation is \[r=\frac{\sum(x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum(x_i-\bar{x})^2\sum(y_i-\bar{y})^2}}\]
where the the $x_i$s are observations for your first variable and $y_i$ are the observations for your second variable.

For the first part of our lesson we're going to be using the data set `corr_match`. In the console below, take a look at the data set to get a good impression about what the data looks like. What are the dimension? What are the names of the variables?

```{r sandbox, exercise=TRUE}

```

We're going to be looking at how the variable `x` correlates with the other variables. In the console below, please create a scatter plot of `x` and `y1`:

```{r first-scat, exercise=TRUE}
ggplot(data = ____, aes(x = ____, y = ____)) +
  geom_point()
```

Based on this scatter plot, estimate the correlation coefficient between `x` and `y1` (don't write any code in this part, just a comment with your best guess):

```{r first-cor-guess, exercise=TRUE}
# 
```

Now use R to compute the true correlation coefficient between `x` and `y`:

```{r first-cor, exercise=TRUE}
corr_match %>%
  summarize(cor(____, ____))
```

Was your guess close? If not, why?

```{r first-ref, exercise=TRUE}
# 
```

We are going to repeat this process for the other variables. In the console's below, please repeat this process for each `y2` though `y8`. Please keep track of your answer using a piece of paper or text editor:

Scatter plot:

```{r sec-scat, exercise=TRUE}

```

Guess of correlation coefficient:

```{r sec-cor-guess, exercise=TRUE}
# 
```

Actual correlation coefficient:

```{r sec-cor, exercise=TRUE}

```

Was your guess close? If not, why?

```{r sec-ref, exercise=TRUE}
# 
```

### Line Fitting

We're not going to focus on the data set `bdims`. Run the console below to display the metadata for `bdims`:

```{r bdims-help, exercise=TRUE}
?bdims
```

Let's suppose you're creating a model to help people figure out what size shirt they should try-on, based on their height. We'll be trying to model chest diameter (`che_di`) as a function of height (`hgt`). In the console below, create a scatter plot with `hgt` on the x-axis and `che_di` on the y-axis:

```{r bdims-scatter, exercise=TRUE}

```


We'd like to fit a line of the form $y=b_0 + b_1*x$ to this data. In the console below adjust `b1` (the slope of your line) and `b` the y-intercept until you find a line which visually seems to fit the data well:

```{r visual-line-fit, exercise=TRUE}
b0 <- 57
b1 <- -.5

ggplot(bdims, aes(x=hgt, y=che_di)) +
  geom_point() +
  geom_abline(intercept = b0, slope = b1, color="red")
```

In the console below use the line above to create a new columns in the `bdims` data set called `y_pred` that contains the predicted values of `y`. Then create another column called `residuals`
with the residuals from your model. You should be able to use one mutate function to do both of these calculations even though `residuals` will depend on `y_pred`. Finally, create a scatter plot with `hgt` on the x-axis and `residuals` on the y-axis. Play around with the values of `b1` and `b0` to see if you can find a line which you think fits the data better (i.e. results in smaller residuals):


```{r residuals-line-fit, exercise=TRUE}
b0 <- .5
b1 <- -57

# Use mutate to add y_pred and residuals column to bdims



# Create scatter plot of hgt and residuals



```


With your group, take 5-10 minutes to think of a more rigorous criteria for evaluating how well a line fits the data. You will be asked to share your method with the class.


In the console below, use your criteria to evaluate how well your chosen line is working. If you'd like to play around with your values of `b0` and `b1` to find a better fitting line, go for it:

```{r line-eval, exercise=TRUE}
b0 <- .5
b1 <- -57

# Copy your code from above (which creates y_pred and residuals) here



# Evaluate your line (mutate and summarize will likely be useful here)



```